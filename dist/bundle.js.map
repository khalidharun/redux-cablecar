{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 13397ec5d75a48815269","webpack:///./src/actions.js","webpack:///./src/middleware.js","webpack:///./src/cableCar.js","webpack:///./src/index.js"],"names":["connect","disconnect","subscribe","unsubscribe","send","ActionCable","url","type","cable","channel","params","payload","car","middleware","action","store","newState","next","CableCar","consumer","createConsumer","dispatch","options","prefix","toUpperCase","subscription","subscriptions","create","initialized","connected","disconnected","received","data","rejected","Error","JSON","stringify","identifier","findAll","map","item","x","actions"],"mappings":"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","file":"bundle.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"ReduxCableCar\"] = factory();\n\telse\n\t\troot[\"ReduxCableCar\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 13397ec5d75a48815269","export function connect(ActionCable, url) {\n  return {\n    type: 'CABLE_CONNECT',\n    cable: { ActionCable, url }\n  };\n}\n\nexport function disconnect() {\n  return {\n    type: 'CABLE_DISCONNECT',\n    cable: {}\n  };\n}\n\nexport function subscribe(channel, params) {\n  return {\n    type: 'CABLE_SUBSCRIBE',\n    cable: { channel, params }\n  };\n}\n\nexport function unsubscribe(channel, params) {\n  return {\n    type: 'CABLE_UNSUBSCRIBE',\n    cable: { channel, params }\n  };\n}\n\nexport function send(channel, params, payload) {\n  return {\n    type: 'CABLE_SEND',\n    cable: { channel, params },\n    payload\n  };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/actions.js","import CableCar from './cableCar';\n\nlet car;\n\nconst middleware = store => next => (action) => {\n\n  switch (action.type) {\n    case 'CABLE_CONNECT':\n      const { ActionCable, url } = action.cable;\n      new CableCar(ActionCable, url, store);\n      break;\n    case 'CABLE_SUBSCRIBE':\n      car.subscribe(action.cable.channel, action.cable.params);\n      break;\n    case 'CABLE_UNSUBSCRIBE':\n      car.unsubscribe(action.cable.channel, action.cable.params);\n      break;\n    case 'CABLE_DISCONNECT':\n      car.disconnect();\n      car = null;\n      break;\n    case 'CABLE_SEND':\n      car.send(action.cable.channel, action.cable.params, action.payload);\n    default:\n      break;\n  }\n\n  const newState = next(action);\n\n  switch (action.type) {\n    case 'CABLE_CONNECTED':\n      car = action.cable.car;\n      break;\n    default:\n      break;\n  }\n\n  return newState;\n};\n\nmiddleware.connect = (url, store) => new CableCar(url, store);\n\nexport default middleware;\n\n\n\n// WEBPACK FOOTER //\n// ./src/middleware.js","class CableCar {\n\n  constructor(ActionCable, url, store) {\n    this.store = store;\n    this.consumer = ActionCable.createConsumer(url);\n    this.store.dispatch({ type: 'CABLE_CONNECTED', cable: { car: this } });\n  }\n\n  dispatch(type, cable, payload = {}) {\n    const action = {\n      type: `CABLE_${type}`,\n      cable,\n      payload,\n    };\n    this.store.dispatch(action);\n  }\n\n  subscribe(channel, params) {\n    const options = { channel , ...params};\n    const prefix = channel.toUpperCase();\n    this.subscription = this.consumer.subscriptions.create(options, {\n      initialized:  () => this.dispatch(`${prefix}_INITIALIZED`, options),\n      connected:    () => this.dispatch(`${prefix}_CONNECTED`, options),\n      disconnected: () => this.dispatch(`${prefix}_DISCONNECTED`, options),\n      received: (data) => this.dispatch(`${prefix}_RECEIVED`, options, data),\n      rejected:     () => {\n        this.dispatch(`${prefix}_REJECTED`, options);\n        throw new Error(`ActionCable: Attempt to subscribe was rejected. (${JSON.stringify(options)})`);\n      }\n    });\n  }\n\n  send(channel, params, payload) {\n    const options = { channel, ...params };\n    const identifier = JSON.stringify(options);\n    const subscriptions = this.consumer.subscriptions.findAll(identifier);\n    subscriptions.map(item => item.send(payload));\n  }\n\n  unsubscribe(channel, params) {\n    const options = { channel, ...params };\n    const identifier = JSON.stringify(options);\n    const subscriptions = this.consumer.subscriptions.findAll(identifier);\n    subscriptions.map( x => x.unsubscribe());\n  }\n\n  disconnect() {\n    this.consumer.disconnect();\n    this.store.dispatch({ type: 'CABLE_DISCONNECTED' });\n  }\n}\n\nexport default CableCar;\n\n\n\n// WEBPACK FOOTER //\n// ./src/cableCar.js","import * as actions from './actions';\nimport middleware from './middleware';\n\nexport { actions, middleware };\nexport default { actions, middleware };\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js"],"sourceRoot":""}